# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

tasks:
  - name: Setup
    init: >
      yarn install;   
      echo APP_SECRET=$(openssl rand -base64 12) > .env;
      echo DATABASE_URL=postgresql://postgres:postgres@localhost:5432/helpdesk?schema=public >> .env;
      docker-compose up -d;
      npx prisma db push;
      npx prisma generate;
      yarn build;
      gp sync-done setup;
    command: echo "Setup done"
  - name: Dev Server
    init: gp sync-await setup
    command: yarn dev

# Ports to expose on workspace startup
ports:
  # Nextjs
  - port: 3000
    onOpen: ignore
    visibility: public

  # Postgres
  - port: 5432
    onOpen: ignore
    visibility: public 

vscode:
  extensions:
    - dbaeumer.vscode-eslint
    - mikestead.dotenv
    - graphql.vscode-graphql
    - esbenp.prettier-vscode
    - eamodio.gitlens
    - pflannery.vscode-versionlens
    - wix.vscode-import-cost
    - formulahendry.auto-close-tag
    - bradlc.vscode-tailwindcss
    - bierner.markdown-preview-github-styles
    - pkief.material-icon-theme